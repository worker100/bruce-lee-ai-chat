<!DOCTYPE html>
<html>
<head>
    <title>最小测试</title>
    <style>
        .search-sources-container { margin: 20px; }
        .search-sources-toggle { 
            background: #f0f0f0; 
            border: 1px solid #ccc; 
            padding: 10px; 
            cursor: pointer; 
            border-radius: 5px;
        }
        .search-sources-panel { 
            margin-top: 10px; 
            padding: 10px; 
            background: #f9f9f9; 
            border: 1px solid #ddd; 
            border-radius: 5px;
        }
        .search-source-item { 
            margin: 5px 0; 
            padding: 5px; 
            background: white; 
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <h1>最小搜索测试</h1>
    
    <div id="test-area"></div>

    <script>
        // 测试数据
        const testSources = [
            { title: "测试文章1", url: "https://example.com/1", snippet: "这是测试摘要1" },
            { title: "测试文章2", url: "https://example.com/2", snippet: "这是测试摘要2" }
        ];

        // 生成HTML
        function createSearchHTML() {
            const id = 'test-' + Date.now();
            return `
                <div class="search-sources-container">
                    <button class="search-sources-toggle" onclick="toggleTest('${id}')">
                        🔍 搜索了 2 篇网页 ▼
                    </button>
                    <div class="search-sources-panel" id="${id}" style="display: none;">
                        <div>参考资料 (2)</div>
                        ${testSources.map((source, i) => `
                            <div class="search-source-item">
                                <strong>${i + 1}. ${source.title}</strong><br>
                                <small>${source.snippet}</small>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        // 切换函数
        function toggleTest(id) {
            console.log('点击了按钮，ID:', id);
            const panel = document.getElementById(id);
            if (!panel) {
                console.error('找不到面板:', id);
                return;
            }
            
            const isHidden = panel.style.display === 'none' || panel.style.display === '';
            panel.style.display = isHidden ? 'block' : 'none';
            console.log(isHidden ? '✅ 展开' : '✅ 收起');
        }

        // 初始化
        document.getElementById('test-area').innerHTML = createSearchHTML();
    </script>
</body>
</html>

# 🔧 关闭深度思考功能说明

## 问题描述
模型回答时会输出深度思考过程（如"用户问..."、"我需要..."等内容），而不是直接给出最终答案。

## 解决方案

根据[火山方舟官方文档](https://www.volcengine.com/docs/82379/1449737#fa3f44fa)，使用官方的 `thinking` 参数来控制深度思考功能。

### 修改内容

**文件**：`src/js/app.js`  
**位置**：第657-660行

```javascript
// API请求（非流式输出）
const requestBody = {
    model: config.endpointId,
    messages: messages,
    temperature: config.modelParams?.temperature || 0.7,
    max_tokens: config.modelParams?.max_tokens || 2000,
    top_p: config.modelParams?.top_p || 0.9,
    stream: false,
    // 关闭深度思考（火山方舟官方参数）
    thinking: {
        type: "disabled"  // disabled: 关闭深度思考，enabled: 开启深度思考，auto: 自动判断
    }
};
```

## 官方参数说明

### `thinking.type` 参数取值

- **`disabled`**: 强制关闭深度思考能力，模型不输出思维链内容
- **`enabled`**: 强制开启深度思考能力，模型强制输出思维链内容
- **`auto`**: 模型自行判断是否需要进行深度思考

### 支持的模型

| 模型 | 支持的取值 | 默认值 |
|------|-----------|--------|
| doubao-seed-1-6-flash-250828 | enabled, disabled | enabled |
| doubao-seed-1-6-flash-250715 | enabled, disabled | enabled |
| doubao-seed-1-6-flash-250615 | enabled, disabled | enabled |
| doubao-seed-1-6-250615 | enabled, disabled, auto | enabled |
| doubao-seed-1-6-vision-250815 | enabled, disabled | enabled |

更多模型支持情况请参考[官方文档](https://www.volcengine.com/docs/82379/1449737#fa3f44fa)。

## 使用效果

### 修改前
```
用户问了关于困难的问题，我需要用李小龙的哲学来回答...
首先，分析用户的需求...
然后，我应该...

困难如拳，别躲避，去感受它的方向。
Be water，顺势而为，化解而非对抗。
```

### 修改后
```
困难如拳，别躲避，去感受它的方向。
Be water，顺势而为，化解而非对抗。
```

## 测试方法

1. **清除浏览器缓存**：按 `Ctrl+Shift+R` 强制刷新
2. **提问测试**：
   ```
   问：如何面对困难？
   期望：直接给出回答，不包含思考过程
   ```
3. **检查控制台**：
   - 打开 F12 开发者工具
   - 查看 Console 选项卡
   - 应该看到 `📝 回答内容:` 而不是思考过程

## 注意事项

### 1. 模型选择
确保你使用的模型支持 `thinking` 参数。如果使用不支持的模型，参数会被忽略。

### 2. 配置文件
确认 `config.local.js` 中的 `endpointId` 与实际使用的模型一致：
```javascript
endpointId: 'doubao-seed-1-6-flash-250828',  // 或其他支持的模型
```

### 3. 兼容性
- ✅ 向后兼容：旧的消息记录依然可以正常显示
- ✅ 不影响其他功能：联网搜索、流式输出等功能正常工作

## 如果还有思考过程

如果修改后仍然出现思考过程，请检查：

1. **是否清除了缓存**：强制刷新页面（Ctrl+Shift+R）
2. **模型是否支持**：参考上面的支持列表
3. **参数是否生效**：打开 F12，在 Network 选项卡查看请求体中是否包含 `thinking` 参数
4. **系统提示词**：确保 `config.local.js` 中的系统提示词也强调了直接回答

## 如需开启深度思考

如果你想让模型显示思考过程，可以修改参数：

```javascript
thinking: {
    type: "enabled"  // 强制开启深度思考
}
```

或者：

```javascript
thinking: {
    type: "auto"  // 让模型自动判断
}
```

## 参考资料

- [火山方舟官方文档 - 深度思考控制](https://www.volcengine.com/docs/82379/1449737#fa3f44fa)

---

**修改完成时间**：2025-10-04  
**修改文件**：`src/js/app.js`（第657-660行）  
**核心方法**：使用官方的 `thinking: { type: "disabled" }` 参数关闭深度思考

